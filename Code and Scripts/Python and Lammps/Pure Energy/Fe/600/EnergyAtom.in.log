units metal
dimension 3
boundary p p p
atom_style atomic
variable latparam equal 2.855312

# ---------- Create Atoms ---------------------
lattice 	bcc ${latparam}
lattice 	bcc 2.855312
Lattice spacing in x,y,z = 2.85531 2.85531 2.85531
region	whole block 0 10 0 10 0 10 units lattice
create_box   1 whole
Created orthogonal box = (0 0 0) to (28.5531 28.5531 28.5531)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region whole
Created 2000 atoms

# ---------- Define Interatomic Potential ---------------------
pair_style eam/fs
pair_coeff * * Fe_2.eam.fs Fe

compute csym all centro/atom bcc
compute eng all pe/atom
compute eatoms all reduce sum c_eng

 # ----------- EQUILIBRATION --------------------
write_dump all custom dump.img_pre_equil.cfg mass type xs ys zs
WARNING: Calling write_dump before a full system init. (../write_dump.cpp:81)
reset_timestep	0
timestep 0.001
velocity all create 600 12345 mom yes rot no
fix 2 all npt temp 600 600 0.01 iso 0 0 1 drag 1

thermo 1000
thermo_style custom step temp pe lx ly lz press pxx pyy pzz c_eatoms
dump 5 all cfg 1000 dump.equal_*.cfg mass type xs ys zs c_csym c_eng fx fy fz
dump_modify     5 element Fe

# Run for at least 10 picosecond (assuming 1 fs timestep)
write_dump all custom dump.img_post_equil.cfg mass type xs ys zs
WARNING: Calling write_dump before a full system init. (../write_dump.cpp:81)

run 20000
Neighbor list info ...
  2 neighbor list requests
  update every 1 steps, delay 10 steps, check yes
  master list distance cutoff = 7.3
  ghost atom cutoff = 7.3
Memory usage per processor = 4.27045 Mbytes
Step Temp PotEng Lx Ly Lz Press Pxx Pyy Pzz eatoms 
       0          600   -8244.8702     28.55312     28.55312     28.55312    7137.1338    7034.1947     7112.908    7264.2986   -8244.8702 
    1000    606.43634   -8088.0907    28.674179    28.674179    28.674179   -1135.2784   -833.70948   -1525.7341   -1046.3917   -8088.0907 
    2000    604.96776   -8075.6381    28.681166    28.681166    28.681166     -1736.86   -1953.5558   -1895.0345   -1361.9897   -8075.6381 
    3000    598.48085   -8074.6745    28.687587    28.687587    28.687587   -2282.6579   -2986.1429   -1927.2547   -1934.5761   -8074.6745 
    4000    593.29639   -8077.4422     28.67346     28.67346     28.67346   -462.50405   -346.85482   -649.75188   -390.90545   -8077.4422 
    5000    596.19482   -8076.2073    28.678879    28.678879    28.678879   -1026.1171   -1440.8979    -1154.034   -483.41934   -8076.2073 
    6000    601.34783   -8074.3468    28.674073    28.674073    28.674073   -428.77667   -572.97002   -500.06558   -213.29442   -8074.3468 
    7000    592.49874   -8075.6779    28.673815    28.673815    28.673815   -421.03254   -369.43386   -647.84417   -245.81959   -8075.6779 
    8000    596.15103   -8079.8553    28.672865    28.672865    28.672865   -563.12285   -184.82352    -1077.088   -427.45708   -8079.8553 
    9000     598.5365   -8077.0575    28.678396    28.678396    28.678396   -1586.1321   -1198.6432   -1941.1673   -1618.5857   -8077.0575 
   10000    593.04204     -8075.28    28.674008    28.674008    28.674008    199.26232    401.63558    150.13545    46.015928     -8075.28 
   11000    594.08757   -8077.6325    28.674218    28.674218    28.674218   -352.91324   -1067.5688   -72.819207    81.648314   -8077.6325 
   12000    598.97936   -8077.3949    28.669811    28.669811    28.669811    39.244707    114.73043   -109.18071     112.1844   -8077.3949 
   13000    606.97946   -8075.1465    28.675623    28.675623    28.675623   -561.23711   -152.00566    -548.7537   -982.95198   -8075.1465 
   14000    601.76512   -8079.0483    28.677158    28.677158    28.677158   -1260.3295   -1363.8024   -1531.0977    -886.0885   -8079.0483 
   15000    597.38172   -8078.7187    28.678434    28.678434    28.678434   -1018.7651   -532.64849   -886.82522   -1636.8216   -8078.7187 
   16000    599.57583   -8073.2885    28.674053    28.674053    28.674053    368.86261    363.14506    534.28119    209.16158   -8073.2885 
   17000     605.9184   -8076.7233    28.675776    28.675776    28.675776   -151.53743   -595.06501    3.3424734    137.11025   -8076.7233 
   18000    602.05012   -8080.1474    28.673292    28.673292    28.673292    84.419926   -37.107748   -305.01573    595.38325   -8080.1474 
   19000    599.21742   -8078.9332    28.669221    28.669221    28.669221    224.86774    81.835201   -123.13088    715.89888   -8078.9332 
   20000     595.9643   -8075.3123    28.668331    28.668331    28.668331    748.08151    472.53472      806.001    965.70882   -8075.3123 
Loop time of 7112.28 on 4 procs for 20000 steps with 2000 atoms

Pair  time (%) = 2111.73 (29.6913)
Neigh time (%) = 0 (0)
Comm  time (%) = 3114.85 (43.7954)
Outpt time (%) = 10.0624 (0.141479)
Other time (%) = 1875.64 (26.3718)

Nlocal:    500 ave 500 max 500 min
Histogram: 4 0 0 0 0 0 0 0 0 0
Nghost:    2936 ave 2936 max 2936 min
Histogram: 4 0 0 0 0 0 0 0 0 0
Neighs:    34000 ave 35082 max 32891 min
Histogram: 1 0 1 0 0 0 0 1 0 1
FullNghs:  68000 ave 68000 max 68000 min
Histogram: 4 0 0 0 0 0 0 0 0 0

Total # of neighbors = 272000
Ave neighs/atom = 136
Neighbor list builds = 0
Dangerous builds = 0
unfix 2
write_dump all custom dump.img_post_equil.cfg mass type xs ys zs
print "test1"
test1

# ---------- Run 0 ---------------------
compute engperatom all pe/atom

# ---------- Run 0 ---------------------
thermo 1
thermo_style custom step temp pe etotal
dump 1 all custom 1 dump.atom.* id x y z c_engperatom
run 0
WARNING: No fixes defined, atoms won't move (../verlet.cpp:55)
Memory usage per processor = 5.66521 Mbytes
Step Temp PotEng TotEng 
   20000     595.9643   -8075.3123   -7921.3204 
Loop time of 0.0109999 on 4 procs for 0 steps with 2000 atoms

Pair  time (%) = 0 (0)
Neigh time (%) = 0 (0)
Comm  time (%) = 0 (0)
Outpt time (%) = 0 (0)
Other time (%) = 0.0109999 (100)

Nlocal:    500 ave 518 max 488 min
Histogram: 1 1 0 0 1 0 0 0 0 1
Nghost:    2839.75 ave 2863 max 2815 min
Histogram: 1 0 0 1 0 0 0 1 0 1
Neighs:    35022.5 ave 35755 max 33649 min
Histogram: 1 0 0 0 0 0 1 0 0 2
FullNghs:  68000 ave 68000 max 68000 min
Histogram: 4 0 0 0 0 0 0 0 0 0

Total # of neighbors = 272000
Ave neighs/atom = 136
Neighbor list builds = 0
Dangerous builds = 0

variable natoms equal "count(all)"
variable teng equal "pe"
variable ecoh equal "v_teng/v_natoms"

print "Total energy (eV) = ${teng};"
Total energy (eV) = -8075.31225898805;
print "Number of atoms = ${natoms};"
Number of atoms = 2000;
print "Cohesive energy (eV) = ${ecoh};"
Cohesive energy (eV) = -4.03765612949403;
print "%% ecoh = ${ecoh};"
%% ecoh = -4.03765612949403;

print "BAZINGAA"
BAZINGAA
